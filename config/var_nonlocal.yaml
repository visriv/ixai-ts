# in config/var_nonlocal.yaml
data_gen: true
train: true
pointwise_xai_flag: true
pairwise_xai_flag: true

dataset:
  name: var_nonlocal
  all_times: False

  num_samples: 400
  num_series: 3        # D
  seq_len: 50         # T
  noise: 0.1           # default
  split_ratio: 0.8
  a9: 0.8
  a10: 0.75
  edge9: [0, 1]
  edge10: [1, 2]

models:
  - name: transformer
    d_model: 64
    layers: 2

  # - name: lstm
  #   hidden: 64
  #   layers: 2

training:
  batch_size: 32
  epochs: 200


evals:
  loc@k: 5

# ============================
# Pointwise XAI (first-order)
# ============================
pointwise:
  explainer:
    name: ig
    params:
      baseline: zero
      steps: 50
  evals:
    baseline: zero
    k_list: [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8]

# ============================
# Pairwise XAI (second-order)
# ============================
pairwise:
  batch_size: 32
  tau_max: 25
  interaction_method:
    name: ih
    params:
      baseline: zero
  evals:
    delta: 1e-5

sweeps:
  baseline:
    dataset.noise: [0.1]
    pairwise.params.num_permutations: [20]
    pointwise.explainer.name: [ig]
    pointwise.explainer.params.steps: [50]
  noise_sweep:
    sweep:
      dataset.noise: [0.05, 0.1, 0.2, 0.4]

  a9_sweep:
    dataset.a9: [0.5, 0.6, 0.7, 0.8]

  # a10_sweep:
  #   dataset.a10: [0.5, 0.6, 0.7, 0.8]

  transformer_width:
    when:
      model.name: transformer
    sweep:
      model.d_model: [8, 16, 32]

  # lstm_hidden:
  #   when:
  #     model.name: lstm
  #   sweep:
  #     model.hidden: [8, 16, 32]

  interaction_method_sweep:
    sweep:
      pairwise.interaction_method.name: [ih, sti]

  pointwise_xai_sweep:
    sweep:
      pointwise.explainer.name: [ig, deeplift, gradshap] #svs

  sti_num_permutations:
    when:
      pairwise.interaction_method.name: sti
    sweep:
      pairwise.interaction_method.params.num_permutations: [10, 20, 50]
