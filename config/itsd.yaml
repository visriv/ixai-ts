# ============================
# Global pipeline switches
# ============================
data_gen: true
train: true
pointwise_xai: false
pairwise_xai: true

# ============================
# Dataset
# ============================
dataset:
  name: ih_multi
  all_times: false

  num_samples: 400
  seq_len: 50          # T
  num_features: 5      # D
  num_interactions: 1  # M
  noise: 0.05

  label_mode: local

# ============================
# Model
# ============================
model:
  name: transformer
  d_model: 64
  layers: 2

# ============================
# Training
# ============================
training:
  batch_size: 32
  epochs: 100
  lr: 0.0003

# ============================
# Pairwise / interaction XAI
# ============================
experiment:
  interaction_method: ih        # ih | sti
  tau_max: 25
  num_permutations: 20          # K (for STI)
  baseline: mean                # baseline for masking (zero | mean | conditional)

# ============================
# Pointwise XAI (first-order)
# ============================
pointwise:
  explainers:
    - name: integrated_gradients
      params:
        baseline: zero
        steps: 50

    # - name: deeplift
    #   params:
    #     baseline: zero

  perturbation:
    baseline: zero
    k_max: 200
    mode: timepoint              # timepoint | window
    window_size: 1

  output:
    target: label                # label | pred
    score: logit                 # logit | prob

# ============================
# Evaluation metrics
# ============================
evals:
  loc@k: 5
  half_life: true
  spectral: true

# ============================
# Sweeps
# ============================
sweeps:

  VAR-1:                         # Baseline
    noise: [0.1]
    num_permutations: [20]

  VAR-2:                         # Stability wrt permutations
    model.d_model: [16, 32, 64, 128]

  VAR-3:                         # Effect of noise
    noise: [0.05, 0.1, 0.2, 0.4]

  VAR-4:                         # Effect of interaction strength
    num_interactions: [1, 2, 4]

  VAR-5:                         # Model comparison
    model.name:
      - transformer
      # - lstm
      # - tcn
